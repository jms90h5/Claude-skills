namespace com.teracloud.streams.hbase.sample ;

use com.teracloud.streams.hbase::HBASEScan;
composite ScanAndWrite(input queryStream )
{
	param
		type $hbaseOutType ;
		expression<rstring> $file ;
		expression<rstring> $tableName ;
	graph
		stream<I, $hbaseOutType> outStream = HBASEScan(queryStream as I)
		{
			param
				tableName : $tableName ;
		}

		// We write the punctuations explicitly to show what they are.  
		() as fileSink = FileSink(outStream)
		{
			param
				file : $file ;
				writePunctuations: true;
		}

}