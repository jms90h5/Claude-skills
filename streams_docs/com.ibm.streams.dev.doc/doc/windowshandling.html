<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="22.0">
    <head><link rel="shortcut icon" href="../../favicon-light.png"/><link rel="icon" href="../../favicon-light.png"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="DC.rights.owner" content="(C) Copyright 2025"/><meta name="copyright" content="(C) Copyright 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="description" content="The SPL code generation framework provides code generation APIs to ease the common tasks that are associated with window handling."/><meta name="DC.relation" content="../../com.ibm.streams.dev.doc/doc/advancedcodegenerationtopics.html"/><meta name="DC.relation" content="../../com.ibm.streams.dev.doc/doc/dev-container.html"/><meta name="DC.relation" content="../../com.ibm.streams.dev.doc/doc/developing_operators.html"/><meta name="DC.relation" content="../../com.ibm.streams.dev.doc/doc/developing_primitive_operators.html"/><meta name="DC.relation" content="../../com.ibm.streams.dev.doc/doc/creatingprimitiveoperators.html"/><meta name="DC.relation" content="/external-reference/spl/operator/code-generation-api/perl/class_s_p_l_1_1_code_gen.html"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="windowshandling"/><meta name="DC.language" content="en-us"/>        
      <title>Window handling</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../../"/><meta name="wh-toc-id" content="windowshandling-d41691e6242"/><meta name="wh-source-relpath" content="com.ibm.streams.dev.doc/doc/windowshandling.dita"/><meta name="wh-out-relpath" content="com.ibm.streams.dev.doc/doc/windowshandling.html"/>

    <link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../../oxygen-webhelp/app/options/properties.js?buildId=20250729150623"></script>
    <script src="../../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../../oxygen-webhelp/app/search/index/keywords.js?buildId=20250729150623"></script>
    <script defer="defer" src="../../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/template/cobalt.css?buildId=2024012323"/><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/template/params/args.css/cobalt.css?buildId=2024012323"/><link rel="stylesheet" type="text/css" href="../../cobalt.css"/></head>

    <body id="windowshandling" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
       <!-- <whc:include_html href="${webhelp.fragment.header}"/>-->
        <header class="navbar navbar-default wh_header_tpc" data-whc_version="23.1">
    <div class="container-fluid">
        <div class="wh_header_flex_container_tpc navbar-nav navbar-expand-md navbar-dark"> 
            <!--<div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    <whc:include_html href="${webhelp.fragment.before.logo_and_title}"/>-->
                    <!--
                            This component will be generated when the next parameters are specified in the transformation scenario:
                            'webhelp.logo.image' and 'webhelp.logo.image.target.url'.
                            See: http://oxygenxml.com/doc/versions/17.1/ug-editor/#topics/dita_webhelp_output.html.
                    -->
                    <!--<whc:webhelp_logo class="d-none d-sm-block"/>
                    <whc:webhelp_publication_title/>
                    <whc:include_html href="${webhelp.fragment.after.logo_and_title}"/>
                </div>-->
                
                <!-- The menu button for mobile devices is copied in the output only when the 'webhelp.show.top.menu' parameter is set to 'yes' -->
                
            <!--</div>-->

            <div class="wh_logo_tpc">
                <a href="/index.html"><img width="200px" height="24px" src="/media/home_button.svg" style="margin-top: 1em;"/></a>
        </div>
        <!-- Search form -->
        <div class=" wh_search_input navbar-form wh_main_page_search search " role="form">
            
            
            
            
            
            <!--<div class="wh_welcome">
                <whc:include_html href="${webhelp.fragment.welcome}"/>
            </div>    -->      
            <form id="searchForm" method="get" role="search" action="../../search.html"><div><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div></form>
            
            
            
            
        </div>
    </div>
</div></header>

        
         
        

        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../../index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="dev-container"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/dev-container.html">Developing</a><div class="wh-tooltip"><p class="shortdesc">Learn about different Teracloud Streams tools and features to write, compile, run, and    test streams applications.</p></div></div></div></li><li><div class="topicref" data-id="developing_operators"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/developing_operators.html">Developing custom operators</a><div class="wh-tooltip"><p class="shortdesc">Create custom operators if shipped toolkits do not provide the necessary logic or   behavior needed for your <span class="keyword">stream applications</span>.</p></div></div></div></li><li><div class="topicref" data-id="developing_primitive_operators"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/developing_primitive_operators.html">Developing primitive operators</a><div class="wh-tooltip"><p class="shortdesc"> You develop new primitive operators by implementing them in the C++ or Java™ language. You must define an operator model that describes the syntax and semantics of the operator and implement the operator logic by creating the header and implementation code generator templates.</p></div></div></div></li><li><div class="topicref" data-id="creatingprimitiveoperators"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/creatingprimitiveoperators.html">Developing C++ primitive operators</a><div class="wh-tooltip"><p class="shortdesc">The SPL language supports writing two styles of primitive operators, namely: generic operators and non-generic operators.</p></div></div></div></li><li><div class="topicref" data-id="advancedcodegenerationtopics"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/advancedcodegenerationtopics.html">Advanced code generation</a><div class="wh-tooltip"><p class="shortdesc">When you create generic operators, you can use advanced code generation techniques for more operator customization and control.</p></div></div></div></li><li class="active"><div class="topicref" data-id="windowshandling"><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/windowshandling.html">Window handling</a><div class="wh-tooltip"><p class="shortdesc">The SPL code generation framework provides code generation APIs to ease the common tasks that are associated with window handling.</p></div></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        <!-- External resource link -->
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <!-- Expand/Collapse publishing TOC 
                             The menu button for mobile devices is copied in the output only when the publication TOC is available
                        -->
                        <button type="button" data-target="#wh_publication_toc" id="wh_toc_button" data-toggle="collapse" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        
                        <nav id="wh_publication_toc" class="collapse col-lg-3 col-md-3 col-sm-12 d-md-block d-print-none" aria-label="Table of Contents Container">
                            <div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem" aria-expanded="false"><div data-tocid="kc_welcome-d41691e179" class="topicref" data-id="kc_welcome" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action kc_welcome-d41691e179-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.welcome.doc/doc/kc-homepage.html" id="kc_welcome-d41691e179-link">Welcome</a><div class="wh-tooltip"><p class="shortdesc">Learn about the core capabilities of <span class="keyword">Teracloud® Streams</span>, its architecture, and key concepts.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="installstreams-container-d41691e427" class="topicref" data-id="installstreams-container" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action installstreams-container-d41691e427-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.install.doc/doc/installstreams-container.html" id="installstreams-container-d41691e427-link">Installing</a><div class="wh-tooltip"><p class="shortdesc"><span class="ph">Use this information to install, upgrade, and uninstall the <span class="keyword">Teracloud® 					Streams</span> product.</span></p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="ibminfospherestreams-containercfg-d41691e1501" class="topicref" data-id="ibminfospherestreams-containercfg" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action ibminfospherestreams-containercfg-d41691e1501-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.cfg.doc/doc/ibminfospherestreams-containercfg.html" id="ibminfospherestreams-containercfg-d41691e1501-link">Configuring</a><div class="wh-tooltip"><p class="shortdesc">Create a basic or an enterprise domain which is a single point for configuring and       managing common resources, security, and instances.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="containeradmin-d41691e2701" class="topicref" data-id="containeradmin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action containeradmin-d41691e2701-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.admin.doc/doc/ibminfospherestreams-containeradmin.html" id="containeradmin-d41691e2701-link">Administering</a><div class="wh-tooltip"><p class="shortdesc">Administer the product by using the <span class="keyword">Teracloud® 					Streams</span> graphical user interface, APIs, or the <code class="ph codeph">streamtool</code> command-line   interface.</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="dev-container-d41691e3979" class="topicref" data-id="dev-container" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action dev-container-d41691e3979-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/dev-container.html" id="dev-container-d41691e3979-link">Developing</a><div class="wh-tooltip"><p class="shortdesc">Learn about different Teracloud Streams tools and features to write, compile, run, and    test streams applications.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="streaming_application_basics-d41691e3994" class="topicref" data-id="streaming_application_basics" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action streaming_application_basics-d41691e3994-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/streaming_application_basics.html" id="streaming_application_basics-d41691e3994-link">Development concepts</a><div class="wh-tooltip"><p class="shortdesc">Development of stream applications consists of several components such as operators,         streams, tuples, Streams Processing Language, toolkits, and         more.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="writingapplications-d41691e4218" class="topicref" data-id="writingapplications" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action writingapplications-d41691e4218-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/writingapplications.html" id="writingapplications-d41691e4218-link">Developing <span class="keyword">stream applications</span></a><div class="wh-tooltip"><p class="shortdesc">Try out tutorials and explore details about stream application development, SPL features,     and best practices.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="creatingnativefunctions-d41691e5698" class="topicref" data-id="creatingnativefunctions" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action creatingnativefunctions-d41691e5698-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/creatingnativefunctions.html" id="creatingnativefunctions-d41691e5698-link"><span class="ph">Developing native functions</span></a><div class="wh-tooltip"><p class="shortdesc">Extend SPL's computational capabilities by creating native functions     written in C++ or Java.</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="developing_operators-d41691e5772" class="topicref" data-id="developing_operators" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action developing_operators-d41691e5772-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/developing_operators.html" id="developing_operators-d41691e5772-link">Developing custom operators</a><div class="wh-tooltip"><p class="shortdesc">Create custom operators if shipped toolkits do not provide the necessary logic or   behavior needed for your <span class="keyword">stream applications</span>.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="choosingoperators-d41691e5787" class="topicref" data-id="choosingoperators" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action choosingoperators-d41691e5787-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/str_optype.html" id="choosingoperators-d41691e5787-link">Types of operators</a><div class="wh-tooltip"><p class="shortdesc">  When developing new operators, developers need to choose the kind of operator to implement based on the task they want to accomplish, the programming language they want to use and the trade-offs they are willing to make between generality and ease of implementation.</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="developing_primitive_operators-d41691e5878" class="topicref" data-id="developing_primitive_operators" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action developing_primitive_operators-d41691e5878-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/developing_primitive_operators.html" id="developing_primitive_operators-d41691e5878-link">Developing primitive operators</a><div class="wh-tooltip"><p class="shortdesc"> You develop new primitive operators by implementing them in the C++ or Java™ language. You must define an operator model that describes the syntax and semantics of the operator and implement the operator logic by creating the header and implementation code generator templates.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="true"><div data-tocid="creatingprimitiveoperators-d41691e5892" class="topicref" data-id="creatingprimitiveoperators" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action creatingprimitiveoperators-d41691e5892-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/creatingprimitiveoperators.html" id="creatingprimitiveoperators-d41691e5892-link">Developing C++ primitive operators</a><div class="wh-tooltip"><p class="shortdesc">The SPL language supports writing two styles of primitive operators, namely: generic operators and non-generic operators.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="operatorimplementation-d41691e5903" class="topicref" data-id="operatorimplementation" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action operatorimplementation-d41691e5903-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/operatorimplementation.html" id="operatorimplementation-d41691e5903-link">Operator implementation</a><div class="wh-tooltip"><p class="shortdesc">You use skeleton template files that are generated by the <span class="keyword cmdname">spl-make-operator</span> script as the basis for operator implementations.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="advancedoperatorimplementationtopics-d41691e5953" class="topicref" data-id="advancedoperatorimplementationtopics" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action advancedoperatorimplementationtopics-d41691e5953-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/advancedoperatorimplementationtopics.html" id="advancedoperatorimplementationtopics-d41691e5953-link">Advanced operator implementation</a><div class="wh-tooltip"><p class="shortdesc">Advanced operator implementation techniques provide additional runtime operator control.</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="advancedcodegenerationtopics-d41691e6124" class="topicref" data-id="advancedcodegenerationtopics" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action advancedcodegenerationtopics-d41691e6124-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/advancedcodegenerationtopics.html" id="advancedcodegenerationtopics-d41691e6124-link">Advanced code generation</a><div class="wh-tooltip"><p class="shortdesc">When you create generic operators, you can use advanced code generation techniques for more operator customization and control.</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="codesharing-d41691e6135" class="topicref" data-id="codesharing" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/codesharing.html" id="codesharing-d41691e6135-link">Code sharing</a><div class="wh-tooltip"><p class="shortdesc">To share code between different operators in a toolkit, use one of the supported sharing methods.</p></div></div></div></li><li role="treeitem"><div data-tocid="errorreporting-d41691e6146" class="topicref" data-id="errorreporting" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/errorreporting.html" id="errorreporting-d41691e6146-link">Error reporting</a><div class="wh-tooltip"><p class="shortdesc">SPL code generation APIs provide four different families of functions that are related to error reporting. These functions are the <code class="ph codeph">print</code>, <code class="ph codeph">warn</code>, <code class="ph codeph">error</code>, and <code class="ph codeph">exit</code> family of functions that are supplied by the <code class="ph codeph">SPL::CodeGen</code> module.</p></div></div></div></li><li role="treeitem"><div data-tocid="typeinspection-d41691e6172" class="topicref" data-id="typeinspection" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/typeinspection.html" id="typeinspection-d41691e6172-link">Type inspection</a><div class="wh-tooltip"><p class="shortdesc">The SPL code generation APIs include various type inspection functions, which are supplied by the <code class="ph codeph">SPL::CodeGen::Type</code> module.</p></div></div></div></li><li role="treeitem"><div data-tocid="checkingschemas-d41691e6186" class="topicref" data-id="checkingschemas" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/checkingschemas.html" id="checkingschemas-d41691e6186-link">Checking schemas</a><div class="wh-tooltip"><p class="shortdesc">Some primitive operators require that the output port has the same schema as the input port. To comply with this requirement, you must check the schema.</p></div></div></div></li><li role="treeitem"><div data-tocid="helperclassgeneration-d41691e6197" class="topicref" data-id="helperclassgeneration" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/helperclassgeneration.html" id="helperclassgeneration-d41691e6197-link">Helper class generation</a><div class="wh-tooltip"><p class="shortdesc">When you develop generic operators, you often need to emit a class, which contains member variables with a list of types. The SPL code generation framework provides an <code class="ph codeph">emitClass</code> function within the <code class="ph codeph">SPL::CodeGen</code> module for this purpose. </p></div></div></div></li><li role="treeitem"><div data-tocid="parameterhelpers-d41691e6214" class="topicref" data-id="parameterhelpers" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/parameterhelpers.html" id="parameterhelpers-d41691e6214-link">Parameter helpers</a><div class="wh-tooltip"><p class="shortdesc"> When you write generic operators, you often must obtain the list of types and expressions that are associated with the parameter expressions. The SPL code generation framework provides helper functions within the <code class="ph codeph">SPL::CodeGen</code> module to simplify this task.</p></div></div></div></li><li role="treeitem"><div data-tocid="outputtuplehelpers-d41691e6228" class="topicref" data-id="outputtuplehelpers" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/outputtuplehelpers.html" id="outputtuplehelpers-d41691e6228-link">Output tuple helpers</a><div class="wh-tooltip"><p class="shortdesc">During code generation for generic operators, you often must initialize or assign an output tuple that is based on output attribute assignments that are captured in the operator instance model. SPL provides helper functions within the <code class="ph codeph">SPL::CodeGen</code> module simplify this task.</p></div></div></div></li><li role="treeitem" class="active"><div data-tocid="windowshandling-d41691e6242" class="topicref" data-id="windowshandling" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/windowshandling.html" id="windowshandling-d41691e6242-link">Window handling</a><div class="wh-tooltip"><p class="shortdesc">The SPL code generation framework provides code generation APIs to ease the common tasks that are associated with window handling.</p></div></div></div></li><li role="treeitem"><div data-tocid="accessingpathscompiletime-d41691e6253" class="topicref" data-id="accessingpathscompiletime" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/accessingpathscompiletime.html" id="accessingpathscompiletime-d41691e6253-link">Accessing paths at compile time</a><div class="wh-tooltip"><p class="shortdesc">The SPL code generation APIs provide the methods to access special paths at code generation time.</p></div></div></div></li><li role="treeitem"><div data-tocid="splexpressiontreevisitor-d41691e6264" class="topicref" data-id="splexpressiontreevisitor" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/splexpressiontreevisitor.html" id="splexpressiontreevisitor-d41691e6264-link">Generating C++ code from an SPL expression tree</a><div class="wh-tooltip"><p class="shortdesc">An <dfn class="term">SPL expression tree</dfn> represents the SPL expression for a parameter or output expression in a form that can be easily traversed in a C++ primitive operator. To use SPL expression trees, the context of the primitive operator must include an <code class="ph codeph">&lt;splExpressionTree [param="true|false"] [output="true|false"] [cppCode="true|false"]/&gt;</code> element.</p></div></div></div></li></ul></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="javaprimitiveoperators-d41691e6281" class="topicref" data-id="javaprimitiveoperators" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action javaprimitiveoperators-d41691e6281-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/javaprimitiveoperators.html" id="javaprimitiveoperators-d41691e6281-link">Developing Java™ primitive operators</a><div class="wh-tooltip"><p class="shortdesc">To create a Java™ primitive operator inside an SPL toolkit, you must provide an operator model. The process is similar to how you provide operator models for C++ primitive operators.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="dev_python_prim_oper-d41691e6594" class="topicref" data-id="dev_python_prim_oper" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action dev_python_prim_oper-d41691e6594-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/dev-python-prim-oper.html" id="dev_python_prim_oper-d41691e6594-link">Developing Python primitive operators</a><div class="wh-tooltip"><p class="shortdesc">To create a Python primitive operator inside an SPL toolkit, you must provide an         operator model. The process is similar to how you provide operator models for C++ primitive         operators.</p></div></div></div></li></ul></li><li role="treeitem"><div data-tocid="creatingcpluslibraries-d41691e6715" class="topicref" data-id="creatingcpluslibraries" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/creatingcpluslibraries.html" id="creatingcpluslibraries-d41691e6715-link">Creating C++ libraries for operators and native functions</a><div class="wh-tooltip"><p class="shortdesc">To enable operators and native functions, you must compile with the appropriate include file paths and options and link any shared libraries against the correct runtime libraries. </p></div></div></div></li><li role="treeitem"><div data-tocid="fusingmultiplejavaoperators-d41691e6726" class="topicref" data-id="fusingmultiplejavaoperators" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/fusingjavaoperators.html" id="fusingmultiplejavaoperators-d41691e6726-link">Fusing multiple Java™ operators into a single PE</a><div class="wh-tooltip"><p class="shortdesc">If multiple Java™ primitive operators and <span class="keyword apiname">JavaOp</span> operator invocations have compatible <span class="keyword parmname">vmArg</span> parameter lists, you can fuse them together into a single processing element (PE) or run them in stand-alone mode.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="best_practices_for_custom_operators-d41691e6749" class="topicref" data-id="best_practices_for_custom_operators" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action best_practices_for_custom_operators-d41691e6749-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/best_practices_for_custom_operators.html" id="best_practices_for_custom_operators-d41691e6749-link">Best practices</a><div class="wh-tooltip"><p class="shortdesc">Use these tips to write operators that perform effectively in their application, and         in other applications.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="perfrecoforprimitiveoperatorimplementors-d41691e6978" class="topicref" data-id="perfrecoforprimitiveoperatorimplementors" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action perfrecoforprimitiveoperatorimplementors-d41691e6978-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/perf_rec_primitive_operatorimplementors.html" id="perfrecoforprimitiveoperatorimplementors-d41691e6978-link">Performance recommendations</a><div class="wh-tooltip"><p class="shortdesc">These tips help you to improve performance of your primitive operators in C++.</p></div></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="creating_toolkits-d41691e7044" class="topicref" data-id="creating_toolkits" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action creating_toolkits-d41691e7044-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/creating_toolkits.html" id="creating_toolkits-d41691e7044-link">Developing custom toolkits</a><div class="wh-tooltip"><p class="shortdesc">Bundle and reuse custom functions and operators across several <span class="keyword">stream applications</span> by creating custom toolkits.</p></div></div></div></li><li role="treeitem"><div data-tocid="enabling-streams-application-service-d41691e7457" class="topicref" data-id="enabling-streams-application-service" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/enabling-streams-data-exchange.html" id="enabling-streams-application-service-d41691e7457-link">Enabling Streams data exchange</a><div class="wh-tooltip"><p class="shortdesc"><span class="keyword">Teracloud® 					Streams</span> provides a data exchange REST API for inserting and retrieving tuples within a job to             easily integrate with other data services and external applications. Stream applications             can enable the data exchange feature by using one or more Endpoint             operators.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="spldebugger-container-d41691e7472" class="topicref" data-id="spldebugger-container" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action spldebugger-container-d41691e7472-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.dev.doc/doc/spldebugger-container.html" id="spldebugger-container-d41691e7472-link">Debugging <span class="keyword">stream applications</span></a><div class="wh-tooltip"><p class="shortdesc">Debug stream applications using the interactive, command line-based <span class="keyword">Streams Debugger</span> (<code class="ph codeph">sdb</code>).</p></div></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshootingforproduct-d41691e8087" class="topicref" data-id="troubleshootingforproduct" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshootingforproduct-d41691e8087-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.pd.doc/doc/ts_parent.html" id="troubleshootingforproduct-d41691e8087-link">Troubleshooting</a><div class="wh-tooltip"><p class="shortdesc">Resolve problems with <span class="keyword">Teracloud® Streams</span> using the troubleshooting tools provided with the product as well as the resources             offered by Teracloud Support.</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="reference-container-d41691e60879" class="topicref" data-id="reference-container" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action reference-container-d41691e60879-link" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.ref.doc/doc/reference-container.html" id="reference-container-d41691e60879-link">Reference</a><div class="wh-tooltip"><p class="shortdesc">Find details on the SPL language, toolkits, APIs, commands, and more.</p></div></div></div></li><li role="treeitem"><div data-tocid="glossary-d41691e72254" class="topicref" data-id="glossary" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../../com.ibm.streams.glossary.doc/doc/glossary_streams.html" id="glossary-d41691e72254-link">Glossary</a><div class="wh-tooltip"><p class="shortdesc">Use this glossary to find terms and definitions for <span class="keyword">Teracloud® 					Streams</span>.</p></div></div></div></li></ul></div>
                        </nav>
                        
                    
                    
                    <div class="col-lg-9 col-md-9 col-sm-12" id="wh_topic_body">
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1">
<h1 class="- topic/title title topictitle1" id="ariaid-title1">Window handling</h1>

<div class="- topic/body body"><p class="- topic/shortdesc shortdesc">The SPL code generation framework provides code generation
APIs to ease the common tasks that are associated with window handling.</p>
<p class="- topic/p p">These include helper functions within the <code class="+ topic/ph pr-d/codeph ph codeph">SPL::CodeGen</code> module,
which is used for generating code for window definitions and window
initializations, and validating window configurations.</p>
<p class="- topic/p p">The <code class="+ topic/ph pr-d/codeph ph codeph">getWindowCppType</code> function, which is a window
object, and a tuple type as input, returns the C++ class name for
the window. It also takes an optional third argument, which specifies
the partition attribute type for partitioned windows. Here is an example:</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>// This is an &lt;opname&gt;_h.cgt file
&lt;%
  my $partitionByParam = $model-&gt;getParameterByName("partitionBy");
  my $partitionByCppType = ...
  my $window = $model-&gt;getInputPortAt(0)-&gt;getWindow();
  my $windowCppType = ($partitionByParam)
    ? SPL::CodeGen::getWindowCppType($window, "IPort0Type*", "PartitionByType")
    : SPL::CodeGen::getWindowCppType($window, "IPort0Type*");
  ...
%&gt;
class MY_OPERATOR : public MY_BASE_OPERATOR {
public:
  typedef &lt;%=$partitionByCppType%&gt; PartitionByType;
  typedef &lt;%=$windowCppType%&gt; WindowType;
  ...  
private:
  WindowType _window;
};
</code></pre></div>
<div class="- topic/p p">The <code class="+ topic/ph pr-d/codeph ph codeph">getWindowCppInitializer</code> function, which is
a window object, and a tuple type as input, returns a C++ code segment
that can be used as a constructor initializer for the window. It also
takes optional third and fourth arguments, which specify attribute
getter function names for delta-based eviction and trigger polices. The following
example illustrates a common use case:</div>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>// This is an &lt;opname&gt;_cpp.cgt file
&lt;%
  my $window = $model-&gt;getInputPortAt(0)-&gt;getWindow();
  my $windowCppInitializer = SPL::CodeGen::getWindowCppInitializer($window, "IPort0Type*");
  ...
%&gt;
MY_OPERATOR::MY_OPERATOR()
  : MY_BASE_OPERATOR(), _window(&lt;%=$windowCppInitializer%&gt;)
{}
</code></pre></div>
<p class="- topic/p p">The <code class="+ topic/ph pr-d/codeph ph codeph">getPartitionedWindowCppInitializer</code> function,
which is given a window object for a partitioned window, returns the
C++ type initializer for the window. Partition eviction is supported
only if an operator uses the <code class="+ topic/ph pr-d/codeph ph codeph">getPartitionedWindowCppInitializer</code> function.
The SPL compiler warns at compile time if the <code class="+ topic/ph pr-d/codeph ph codeph">getWindowCppInitializer</code> function
is used with a window that has a partition eviction policy.</p>
<p class="- topic/p p">The <code class="+ topic/ph pr-d/codeph ph codeph">checkWindowConfiguration</code> function, which is
given an input port object, and a reference to a window configuration
list, returns whether the input port has a window configuration that
is among the list of configurations that are passed in or not. The <code class="+ topic/ph pr-d/codeph ph codeph">validateWindowConfiguration</code> function
is similar, but rather than returning a value, it prints an error
message and exits in case there are no matching configurations. To
create a configuration list reference, use the <code class="+ topic/ph pr-d/codeph ph codeph">createWindowConfigurations</code> function.
This function takes the input port object and a list of valid window
  configurations as input. Each window configuration is a hash data
structure that contains one or more of the following mappings:</p>
<ul class="- topic/ul ul">
<li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">type =&gt; &lt;window-type&gt;</code>, where the window type
is one of the following constants <code class="+ topic/ph pr-d/codeph ph codeph">$SPL::Operator::Instance::Window::TUMBLING</code> or <code class="+ topic/ph pr-d/codeph ph codeph">SLIDING</code>.</li>
<li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">eviction =&gt; &lt;eviction-policy&gt;</code>, where the eviction
policy is one of the following constants     <code class="+ topic/ph pr-d/codeph ph codeph">$SPL::Operator::Instance::Window::COUNT</code>, <code class="+ topic/ph pr-d/codeph ph codeph">DELTA</code>, <code class="+ topic/ph pr-d/codeph ph codeph">TIME</code>,
or <code class="+ topic/ph pr-d/codeph ph codeph">PUNCT</code>.</li>
<li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">trigger =&gt; &lt;trigger-policy&gt;</code>, where the trigger
policy is one of the following constants     <code class="+ topic/ph pr-d/codeph ph codeph">$SPL::Operator::Instance::Window::COUNT</code>, <code class="+ topic/ph pr-d/codeph ph codeph">DELTA</code>,
or <code class="+ topic/ph pr-d/codeph ph codeph">TIME</code>.</li>
<li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">partitioned =&gt; &lt;partition-status&gt;</code>, where the
partition status is <code class="+ topic/ph pr-d/codeph ph codeph">0</code> or <code class="+ topic/ph pr-d/codeph ph codeph">1</code>.</li>
</ul>
<p class="- topic/p p">Each mapping in the hash data structure is a constraint and the
hash itself represents a conjunction of these constraints. For instance,
if the hash contains both type and partitioned mappings, then it represents
windows configurations that match both constraints.</p>
<p class="- topic/p p">The following example shows where it is checked whether the window
is a tumbling window of any kind or a sliding window with a count-based
eviction and trigger policy. The example uses the <code class="+ topic/ph pr-d/codeph ph codeph">createWindowConfigurations</code> function
to create a configuration list reference. It passes a set of valid
configurations. The list has two entries. The first one is a configuration
that captures all tumbling windows. The second one is a configuration
that captures sliding windows with count-based eviction and trigger
policies.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>my $confs = SPL::CodeGen::createWindowConfigurations(
        { type     =&gt; $SPL::Operator::Instance::Window::TUMBLING }, # conf 1
        { type     =&gt; $SPL::Operator::Instance::Window::SLIDING,    # conf 2
          eviction =&gt; $SPL::Operator::Instance::Window::COUNT,
          trigger  =&gt; $SPL::Operator::Instance::Window::COUNT});
my $iport = $model-&gt;getInputPortAt(0);
SPL::CodeGen::validateWindowConfiguration($iport, $confs);
</code></pre></div>
<p class="- topic/p p"> <strong class="+ topic/ph hi-d/b ph b">Putting it All Together:</strong> Now take a second look at the <code class="+ topic/ph pr-d/codeph ph codeph">SensorQuery</code> application from <a class="- topic/xref xref" href="windowhandling.html" title="The SPL language run time provides APIs for building window-based operators.">Window handling</a>. This
example rewrites the <code class="+ topic/ph pr-d/codeph ph codeph">FindReadings</code> operator that is
used in that application as a generic operator that handles all variations
of the eviction policies for the sliding window it defines on the
sensor readings. The name of this new operator is <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code>,
since it matches the queries that are received on its second input
port against the table of readings that are maintained as a sliding
window on its ﬁrst input port. This operator also supports arbitrary
match expressions. Similar to the <code class="+ topic/ph pr-d/codeph ph codeph">FindReadings</code> operator,
it outputs matches as part of the query processing. It also outputs
the popular readings on a second output port, as part of evictions,
just like <code class="+ topic/ph pr-d/codeph ph codeph">FindReadings</code> does. For brevity, the operator
model is not described. The interested reader can check the <span class="+ topic/ph sw-d/filepath ph filepath">sample/feature/WindowLibrary</span> that
comes with the product installation for details. The sample contains
the complete implementations of the <code class="+ topic/ph pr-d/codeph ph codeph">FindReadings</code> and <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code> operators,
together with the <code class="+ topic/ph pr-d/codeph ph codeph">SampleQuery</code> sample application.
Here is the sample use of the <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code> operator
in SPL.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>(stream&lt;Match&gt; Matches; stream&lt;Reading&gt; PopReadings)
 = TableMatch(Readings as R; Queries as Q) {
 window
  R : sliding, count(100);
 param
  match : sqrt(
   pow(R.position.x - Q.position.x, 2.0) +
   pow(R.position.y - Q.position.y, 2.0)) &lt; Q.distance;
  threshold : 3u;
}
</code></pre></div>
<p class="- topic/p p">Unlike the <code class="+ topic/ph pr-d/codeph ph codeph">FindReadings</code> operator, the <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code> operator
allows the specification of a window on its ﬁrst input port and has
a <span class="+ topic/keyword pr-d/parmname keyword parmname">match</span> parameter that accepts arbitrary Boolean
conditions.</p>
<p class="- topic/p p">Now look at the implementation of the <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code> operator.
Start with the <code class="+ topic/ph pr-d/codeph ph codeph">TableMatchCommon</code> Perl module that
checks for a few errors that are not covered by the operator model.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>package TableMatchCommon;
use strict;
use warnings;
sub verify($) {
  my ($model) = @_;
  my $lhsInputPort = $model-&gt;getInputPortAt(0);
  my $rhsOutputPort = $model-&gt;getOutputPortAt(1);
  if($lhsInputPort-&gt;getCppTupleType() ne $rhsOutputPort-&gt;getCppTupleType()) {
    SPL::CodeGen::exitln("Schema for the output port at index 1 does not match".
      "that of input port at index 0", $rhsOutputPort-&gt;getSourceLocation());
  }
  my $confs = SPL::CodeGen::createWindowConfigurations(
         { type      =&gt; $SPL::Operator::Instance::Window::SLIDING,
           trigger =&gt; $SPL::Operator::Instance::Window::COUNT});
  SPL::CodeGen::validateWindowConfiguration($lhsInputPort, $confs);
} 1;
</code></pre></div>
<p class="- topic/p p">Two checks are performed by the module. First, it makes sure that
the schema of the second output port that is used to output popular
readings matches the schema of the ﬁrst input port that is used to
receive the readings. Second, it employs the <code class="+ topic/ph pr-d/codeph ph codeph">createWindowConfigurations</code> and <code class="+ topic/ph pr-d/codeph ph codeph">validateWindowConfiguration</code> code
generation helper routines to make sure that a valid window configuration
is specified. In this case, all sliding windows with a count-based
trigger policy are allowed. Recall that the <code class="+ topic/ph pr-d/codeph ph codeph">TableMatch</code> operator
does not use trigger processing and the trigger policy defaults to <code class="+ topic/ph pr-d/codeph ph codeph">count(1)</code> when
it is omitted in the SPL operator invocation.</p>
<p class="- topic/p p">Now look at the header code generator template.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>&lt;%
  use TableMatchCommon;
  TableMatchCommon::verify($model);
  my $windowLHS = $model-&gt;getInputPortAt(0)-&gt;getWindow();
  my $windowCppType = SPL::CodeGen::getWindowCppType($windowLHS, "IPort0Type*");
  my $windowEventType = SPL::CodeGen::getWindowEventCppType($windowLHS, "IPort0Type*");
%&gt;
&lt;%SPL::CodeGen::headerPrologue($model);%&gt;
  class MY_OPERATOR : public MY_BASE_OPERATOR {
  public:
   typedef &lt;%=$windowCppType%&gt; WindowType;
   typedef &lt;%=$windowEventType%&gt; WindowEventType;
   struct WindowHandler : WindowEventType {
     WindowHandler(MY_OPERATOR &amp; op) : op_(op) {}
     void beforeTupleEvictionEvent(WindowType &amp; window,
       TupleType &amp; tuple, PartitionType const &amp;)
       { op_.evict(*tuple); }
     MY_OPERATOR &amp; op_;
   }; 
   MY_OPERATOR();
   virtual ~MY_OPERATOR();
   void process(Tuple const &amp; tuple, uint32_t port);
   void evict(IPort0Type &amp; tuple);
  private:
   Mutex mutex_;
   WindowType windowOfReadings_;
   WindowHandler windowHandler_;
   map&lt;uintptr_t,uint32&gt; matchedReadings_;
};
&lt;%SPL::CodeGen::headerEpilogue($model);%&gt;
</code></pre></div>
<p class="- topic/p p">This version is almost the same as the non-generic version, with
a few differences. First, it uses the <code class="+ topic/ph pr-d/codeph ph codeph">headerPrologue</code> and <code class="+ topic/ph pr-d/codeph ph codeph">headerEpilogue</code> code
generation helper routines, instead of the <code class="+ topic/ph pr-d/codeph ph codeph">#pragma</code>'s
used for the non-generic version, since it is a generic operator that
is written in mixed-mode C++/Perl. Second, it uses the <code class="+ topic/ph pr-d/codeph ph codeph">getWindowCppType</code> and
the <code class="+ topic/ph pr-d/codeph ph codeph">getWindowEventCppType</code> code generation helper
routines to get the type of the window object and the window event
class it wants to extend from. Then, <code class="+ topic/ph pr-d/codeph ph codeph">typedef</code> to <code class="+ topic/ph pr-d/codeph ph codeph">WindowType</code> and <code class="+ topic/ph pr-d/codeph ph codeph">WindowEventType</code> for
ease of use. Another difference  is that, rather than making the operator
extend from the window event class directly, it creates an inner struct
that extends from the window event class. An instance of this struct,
named <code class="+ topic/ph pr-d/codeph ph codeph">windowHandler_</code>, is defined as a member variable
and routes any <code class="+ topic/ph pr-d/codeph ph codeph">beforeTupleEviction</code> events it receives
to the <code class="+ topic/ph pr-d/codeph ph codeph">evict</code> member function of the operator. This
code provides syntactic clarity,<a name="fnsrc_1" href="#fntarg_1" class=" topic/fn-call fn-call "><sup>1</sup></a> and can scale better
in the case of multiple windows.</p>
<p class="- topic/p p">Now look at the implementation code generator template, and in
particular, the Perl code that sets up a few variables that are later
used in the implementation.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>&lt;%
  use TableMatchCommon;
  TableMatchCommon::verify($model);
  my $class = $model-&gt;getContext()-&gt;getClass();
  my $inputPortLHS = $model-&gt;getInputPortAt(0);
  my $inputPortRHS = $model-&gt;getInputPortAt(1);
  # tuple names used in expressions
  my $readingTuple = $inputPortLHS-&gt;getCppTupleName();
  my $queryTuple = $inputPortRHS-&gt;getCppTupleName();
  # parameter expressions
  my $match = $model-&gt;getParameterByName("match");
  $match = $match-&gt;getValueAt(0)-&gt;getCppExpression();
  my $threshold = $model-&gt;getParameterByName("threshold");
  $threshold = $threshold-&gt;getValueAt(0)-&gt;getCppExpression();
  my $window = $inputPortLHS-&gt;getWindow();
  my $windowCppInitializer = SPL::CodeGen::getWindowCppInitializer($window, "IPort0Type*");
  # assignments used for output tuples
  my $assignments = SPL::CodeGen::getOutputTupleCppInitializer($model-&gt;getOutputPortAt(0));
%&gt;
&lt;%SPL::CodeGen::implementationPrologue($model);%&gt;
...
&lt;%SPL::CodeGen::implementationEpilogue($model);%&gt;
</code></pre></div>
<p class="- topic/p p">Use the <var class="+ topic/keyword sw-d/varname keyword varname">$readingTuple</var> and <var class="+ topic/keyword sw-d/varname keyword varname">$queryTuple</var> variables
to represent the tuple variable names that appear in C++ expressions,
for the ﬁrst and the second port. The <var class="+ topic/keyword sw-d/varname keyword varname">$match</var> variable
is used to represent the match condition expression and the <span class="- topic/ph ph cmtt-10">$threshold</span> variable is used to represent
the threshold that determines popular readings. Use the <code class="+ topic/ph pr-d/codeph ph codeph">getWindowCppInitializer</code> helper
routine to get the expression list to be used for initializing the
window object and the <code class="+ topic/ph pr-d/codeph ph codeph">getOutputTupleCppInitializer</code> helper
routine to get the expression list to be used to initialize the output
tuples sent out for matches. With the Perl variables defined, the
rest of the code is, surprisingly, briefer than the non-generic implementation.</p>
<p class="- topic/p p">First look at the constructor and destructor.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>MY_OPERATOR::MY_OPERATOR()
  : windowOfReadings_(&lt;%=$windowCppInitializer%&gt;),
    windowHandler_(*this)
  { windowOfReadings_.registerBeforeTupleEvictionHandler(&amp;windowHandler_); }
MY_OPERATOR::~MY_OPERATOR()
  { windowOfReadings_.deleteWindowObjects(); }
</code></pre></div>
<p class="- topic/p p">Other than the use of the Perl variable <var class="+ topic/keyword sw-d/varname keyword varname">$windowCppInitializer</var> for
the initialization of the window object, the constructor, and the
destructor are identical to the non-generic case.</p>
<p class="- topic/p p">Now look at the implementation of the processing logic.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock scale-80"><code>void MY_OPERATOR::process(Tuple const &amp; tuple, uint32_t port) {
 AutoPortMutex apm(mutex_, *this);
 if(port==0) {
  IPort0Type const &amp; reading = static_cast&lt;IPort0Type const&amp;&gt;(tuple);
  windowOfReadings_.insert(new IPort0Type(reading));
 } else {
  AutoWindowDataAcquirer&lt;IPort0Type*&gt; awda(windowOfReadings_);
  IPort1Type const &amp; &lt;%=$queryTuple%&gt; = static_cast&lt;IPort1Type const&amp;&gt;(tuple);
  WindowType::DataType &amp; content = windowOfReadings_.getWindowData();
  for(WindowType::DataType::const_iterator it=content.begin(); it!=content.end(); ++it) {
   IPort0Type const &amp; &lt;%=$readingTuple%&gt; = **it;
   if(&lt;%=$match%&gt;) {
    OPort0Type otuple(&lt;%=$assignments%&gt;);
    submit(otuple, 0);
    uintptr_t ptr = reinterpret_cast&lt;uintptr_t&gt;(*it);
    map&lt;uintptr_t,uint32&gt;::iterator mit = matchedReadings_.find(ptr);
    if(mit==matchedReadings_.end())
       matchedReadings_.insert(std::make_pair(ptr,1));
    else
       mit-&gt;second = mit-&gt;second+1;
} } } }
</code></pre></div>
<p class="- topic/p p">The processing logic for the ﬁrst port, that is for the sensor
readings, is the same as the non-generic case. The processing for
the second port, that is for the queries, is very similar, but with
a few differences. First, define tuple aliases with names <var class="+ topic/keyword sw-d/varname keyword varname">$queryTuple</var> and <var class="+ topic/keyword sw-d/varname keyword varname">$readingTuple</var> to
create the right syntactic context for the output assignment expressions
and the match condition expression. Second, <var class="+ topic/keyword sw-d/varname keyword varname">$match</var> is
used in place of the match condition expression, which makes the operator
generic with respect to the match condition. Third, <var class="+ topic/keyword sw-d/varname keyword varname">$assignments</var> is
used as the initializer for the output tuple that is created for matches,
which makes the operator generic with respect to the output assignments.
Finally, the generic version of the operator employs an <code class="+ topic/ph pr-d/codeph ph codeph">AutoWindowDataAcquirer</code> that
guards the access to the window contents. This code is needed because,
unlike the non-generic version, this operator handles windows that
contain time-based eviction policies, in which case an eviction event
might take place while it is doing processing for a query.</p>
<p class="- topic/p p">Finally, look at the eviction event handler.</p>
<div class="- topic/example example"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>void MY_OPERATOR::evict(IPort0Type &amp; reading) {
 uintptr_t ptr = reinterpret_cast&lt;uintptr_t&gt;(&amp;reading);
 map&lt;uintptr_t,uint32&gt;::iterator mit = matchedReadings_.find(ptr);
 if(mit!=matchedReadings_.end()) {
  uint32 numMatches = mit-&gt;second;
  if(numMatches &gt;= &lt;%=$threshold%&gt;)
   submit(reading, 1);
   matchedReadings_.erase(mit);
  }
  delete &amp;reading;
}
</code></pre></div>
<p class="- topic/p p">The only difference between the generic and non-generic versions
is the way the popularity threshold parameter is accessed.</p>
</div>

<div class="- topic/fn fn"><a name="fntarg_1" href="#fnsrc_1"><sup>1</sup></a>  The <code class="+ topic/ph pr-d/codeph ph codeph">TupleType</code> used
in the <code class="+ topic/ph pr-d/codeph ph codeph">beforeTupleEviction</code> member of the <code class="+ topic/ph pr-d/codeph ph codeph">WindowHandler</code> class
is not the one defined in the operator class (that would be <code class="+ topic/ph pr-d/codeph ph codeph">SlidingWindow&lt;...&gt;</code>)
but rather comes from the <code class="+ topic/ph pr-d/codeph ph codeph">WindowEventType</code> base class
(that is <code class="+ topic/ph pr-d/codeph ph codeph">Window&lt;...&gt;</code>).</div></article></main></div>
                        
                        
                        <div class=" wh_related_links d-print-none "><nav aria-label="Related Links" role="navigation" class="- topic/related-links related-links"><div class="- topic/linklist linklist relref" xml:lang="en-us" lang="en-us"><strong>Related reference</strong><ul class="linklist related_link"><li class="linklist"><a class="- topic/link link navheader_parent_path" href="/external-reference/spl/operator/code-generation-api/perl/class_s_p_l_1_1_code_gen.html" target="_blank" rel="external noopener" title="A class that provides code generation helper utilities.">SPL::CodeGen Class Reference</a></li></ul></div></nav></div>
                        
                        <whc:webhelp_feedback xmlns="" xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="d-print-none"></whc:webhelp_feedback>
                        
                        
                    </div>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer" data-whc_version="23.1"> 

  <!--<whc:include_html href="${webhelp.fragment.footer}"/>-->
  
  <div class="footer-container">
    
    <div class="grid-container">
        
        
        <div class="hf"><h4 class="head">Teracloud Streams</h4>
          
          <p class="text-gray">Revolutionizing real-time data analytics with advanced tools, AI integration, and unparalleled expertise.</p></div>
        
        <div class="hs"><h4 class="head">Quick Links</h4>
          <a href="https://streams.teracloud.com" target="_blank" rel="noopener noreferrer" class="links blue">Official Website</a><br/>
            <a href="https://teracloud.com" target="_blank" rel="noopener noreferrer" class="links blue">About Teracloud</a><br/>
            <a href="https://teracloud.com/privacy" target="_blank" rel="noopener noreferrer" class="links blue">Privacy Policy</a>
          </div>
        
        <div class="ht"><h4 class="head">Contact Us</h4>
          
          <a href="mailto:info.streams@teracloud.com" class="text-gray2 links">info.streams@teracloud.com</a></div>
        
        
      
      <div class="bottom-row">© 2025 Teracloud. All rights reserved.</div></div>
  </div>

</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <!-- The modal container for images -->
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="modal-img" alt=""/>
            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>