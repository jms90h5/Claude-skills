<!DOCTYPE HTML>
<!-- begin_generated_IBM_Teracloud_ApS_copyright_prolog               -->
<!--                                                                  -->
<!-- This is an automatically generated copyright prolog.             -->
<!-- After initializing,  DO NOT MODIFY OR MOVE                       -->
<!-- **************************************************************** -->
<!-- Licensed Materials - Property of IBM                             -->
<!-- (C) Copyright Teracloud ApS 2025, 2025, IBM Corp. 2025, 2025     -->
<!-- All Rights Reserved.                                             -->
<!-- US Government Users Restricted Rights - Use, duplication or      -->
<!-- disclosure restricted by GSA ADP Schedule Contract with          -->
<!-- IBM Corp.                                                        -->
<!--                                                                  -->
<!-- end_generated_IBM_Teracloud_ApS_copyright_prolog                 -->
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: com.ibm.streams.operator.samples.operators, class: MaxMinOperator">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/* begin_generated_IBM_Teracloud_ApS_copyright_prolog               */</span>
<span class="source-line-no">002</span><span id="line-2">/*                                                                  */</span>
<span class="source-line-no">003</span><span id="line-3">/* This is an automatically generated copyright prolog.             */</span>
<span class="source-line-no">004</span><span id="line-4">/* After initializing,  DO NOT MODIFY OR MOVE                       */</span>
<span class="source-line-no">005</span><span id="line-5">/* **************************************************************** */</span>
<span class="source-line-no">006</span><span id="line-6">/* THIS SAMPLE CODE IS PROVIDED ON AN "AS IS" BASIS.                */</span>
<span class="source-line-no">007</span><span id="line-7">/* TERACLOUD APS AND IBM MAKES NO REPRESENTATIONS OR WARRANTIES,    */</span>
<span class="source-line-no">008</span><span id="line-8">/* EXPRESS OR IMPLIED, CONCERNING  USE OF THE SAMPLE CODE, OR THE   */</span>
<span class="source-line-no">009</span><span id="line-9">/* COMPLETENESS OR ACCURACY OF THE SAMPLE CODE. TERACLOUD APS       */</span>
<span class="source-line-no">010</span><span id="line-10">/* AND IBM DOES NOT WARRANT UNINTERRUPTED OR ERROR-FREE OPERATION   */</span>
<span class="source-line-no">011</span><span id="line-11">/* OF THIS SAMPLE CODE. TERACLOUD APS AND IBM IS NOT RESPONSIBLE FOR THE */</span>
<span class="source-line-no">012</span><span id="line-12">/* RESULTS OBTAINED FROM THE USE OF THE SAMPLE CODE OR ANY PORTION  */</span>
<span class="source-line-no">013</span><span id="line-13">/* OF THIS SAMPLE CODE.                                             */</span>
<span class="source-line-no">014</span><span id="line-14">/*                                                                  */</span>
<span class="source-line-no">015</span><span id="line-15">/* LIMITATION OF LIABILITY. IN NO EVENT WILL IBM BE LIABLE TO ANY   */</span>
<span class="source-line-no">016</span><span id="line-16">/* PARTY FOR ANY DIRECT, INDIRECT, SPECIAL OR OTHER CONSEQUENTIAL   */</span>
<span class="source-line-no">017</span><span id="line-17">/* DAMAGES FOR ANY USE OF THIS SAMPLE CODE, THE USE OF CODE FROM    */</span>
<span class="source-line-no">018</span><span id="line-18">/* THIS [ SAMPLE PACKAGE,] INCLUDING, WITHOUT LIMITATION, ANY LOST  */</span>
<span class="source-line-no">019</span><span id="line-19">/* PROFITS, BUSINESS INTERRUPTION, LOSS OF PROGRAMS OR OTHER DATA   */</span>
<span class="source-line-no">020</span><span id="line-20">/* ON YOUR INFORMATION HANDLING SYSTEM OR OTHERWISE.                */</span>
<span class="source-line-no">021</span><span id="line-21">/*                                                                  */</span>
<span class="source-line-no">022</span><span id="line-22">/* (C) Copyright Teracloud ApS 2024, 2025, IBM Corp. 2014, 2014     */</span>
<span class="source-line-no">023</span><span id="line-23">/* All Rights reserved.                                             */</span>
<span class="source-line-no">024</span><span id="line-24">/*                                                                  */</span>
<span class="source-line-no">025</span><span id="line-25">/* end_generated_IBM_Teracloud_ApS_copyright_prolog                 */</span>
<span class="source-line-no">026</span><span id="line-26">package com.ibm.streams.operator.samples.operators;</span>
<span class="source-line-no">027</span><span id="line-27"></span>
<span class="source-line-no">028</span><span id="line-28">import com.ibm.streams.operator.AbstractOperator;</span>
<span class="source-line-no">029</span><span id="line-29">import com.ibm.streams.operator.StreamingInput;</span>
<span class="source-line-no">030</span><span id="line-30">import com.ibm.streams.operator.Tuple;</span>
<span class="source-line-no">031</span><span id="line-31">import com.ibm.streams.operator.TupleAttribute;</span>
<span class="source-line-no">032</span><span id="line-32">import com.ibm.streams.operator.model.InputPortSet;</span>
<span class="source-line-no">033</span><span id="line-33">import com.ibm.streams.operator.model.InputPorts;</span>
<span class="source-line-no">034</span><span id="line-34">import com.ibm.streams.operator.model.OutputPortSet;</span>
<span class="source-line-no">035</span><span id="line-35">import com.ibm.streams.operator.model.OutputPorts;</span>
<span class="source-line-no">036</span><span id="line-36">import com.ibm.streams.operator.model.Parameter;</span>
<span class="source-line-no">037</span><span id="line-37">import com.ibm.streams.operator.model.PrimitiveOperator;</span>
<span class="source-line-no">038</span><span id="line-38"></span>
<span class="source-line-no">039</span><span id="line-39">/**</span>
<span class="source-line-no">040</span><span id="line-40"> * Sample operator that demonstrates the usage of CustomLiteral and Attribute</span>
<span class="source-line-no">041</span><span id="line-41"> * parameters.</span>
<span class="source-line-no">042</span><span id="line-42"> * &lt;P&gt;</span>
<span class="source-line-no">043</span><span id="line-43"> * The operator supports 2 parameters:</span>
<span class="source-line-no">044</span><span id="line-44"> * </span>
<span class="source-line-no">045</span><span id="line-45"> * &lt;BR&gt;</span>
<span class="source-line-no">046</span><span id="line-46"> * monitorType: One of 'Max' or 'Min' custom literal to indicate whether the operator is</span>
<span class="source-line-no">047</span><span id="line-47"> * keeping track of max or min values.</span>
<span class="source-line-no">048</span><span id="line-48"> * &lt;BR&gt;</span>
<span class="source-line-no">049</span><span id="line-49"> * monitoredAttr: The attribute on the input schema to monitor for max or min values. The attribute</span>
<span class="source-line-no">050</span><span id="line-50"> * must be an int32.</span>
<span class="source-line-no">051</span><span id="line-51"> * &lt;BR&gt;</span>
<span class="source-line-no">052</span><span id="line-52"> * &lt;/P&gt;</span>
<span class="source-line-no">053</span><span id="line-53"> * </span>
<span class="source-line-no">054</span><span id="line-54"> * &lt;P&gt;</span>
<span class="source-line-no">055</span><span id="line-55"> * The operator processes incoming tuples and keeps track of max/min values (as specified by the monitorType parameter)</span>
<span class="source-line-no">056</span><span id="line-56"> * of the input schema attribute specified by the monitordAttr parameter. The current max/min value is returned as a tuple</span>
<span class="source-line-no">057</span><span id="line-57"> * on the first output port. The original tuples are also passed through on the second output port.</span>
<span class="source-line-no">058</span><span id="line-58"> * &lt;/P&gt;</span>
<span class="source-line-no">059</span><span id="line-59"> * </span>
<span class="source-line-no">060</span><span id="line-60"> */</span>
<span class="source-line-no">061</span><span id="line-61">@PrimitiveOperator(description="Simple sample operator that monitors the incoming tuples and sends the max or min value that is seen on the attribute specified by the monitoredAttr parameter on the first output port along with the original tuple on the second output port.")</span>
<span class="source-line-no">062</span><span id="line-62">@InputPorts(@InputPortSet(cardinality=1))</span>
<span class="source-line-no">063</span><span id="line-63">@OutputPorts(@OutputPortSet(cardinality=2))</span>
<span class="source-line-no">064</span><span id="line-64">public class MaxMinOperator extends AbstractOperator {</span>
<span class="source-line-no">065</span><span id="line-65">        </span>
<span class="source-line-no">066</span><span id="line-66">        </span>
<span class="source-line-no">067</span><span id="line-67">        /**</span>
<span class="source-line-no">068</span><span id="line-68">         * Type of monitoring that is supported</span>
<span class="source-line-no">069</span><span id="line-69">         */</span>
<span class="source-line-no">070</span><span id="line-70">        public enum Type {</span>
<span class="source-line-no">071</span><span id="line-71">                Max,</span>
<span class="source-line-no">072</span><span id="line-72">                Min</span>
<span class="source-line-no">073</span><span id="line-73">        }</span>
<span class="source-line-no">074</span><span id="line-74">        </span>
<span class="source-line-no">075</span><span id="line-75">        private Type monitorType;</span>
<span class="source-line-no">076</span><span id="line-76">        private TupleAttribute&lt;Tuple, Integer&gt; monitoredAttr;</span>
<span class="source-line-no">077</span><span id="line-77">        private int value;</span>
<span class="source-line-no">078</span><span id="line-78">        </span>
<span class="source-line-no">079</span><span id="line-79">        @Parameter(description="Set whether the operator is monitoring 'Max' or 'Min' value")</span>
<span class="source-line-no">080</span><span id="line-80">        public void setMonitorType(Type t) {</span>
<span class="source-line-no">081</span><span id="line-81">                this.monitorType = t;</span>
<span class="source-line-no">082</span><span id="line-82">        }</span>
<span class="source-line-no">083</span><span id="line-83">        </span>
<span class="source-line-no">084</span><span id="line-84">        @Parameter(description="Set the tuple attribute of type 'int32' to monitor.")</span>
<span class="source-line-no">085</span><span id="line-85">        public void setMonitoredAttr(TupleAttribute&lt;Tuple, Integer&gt; mAttr) {</span>
<span class="source-line-no">086</span><span id="line-86">                this.monitoredAttr = mAttr;</span>
<span class="source-line-no">087</span><span id="line-87">        }</span>
<span class="source-line-no">088</span><span id="line-88"></span>
<span class="source-line-no">089</span><span id="line-89">        @Override</span>
<span class="source-line-no">090</span><span id="line-90">        public void process(StreamingInput&lt;Tuple&gt; stream, Tuple tuple)</span>
<span class="source-line-no">091</span><span id="line-91">                        throws Exception {</span>
<span class="source-line-no">092</span><span id="line-92">                int newValue = monitoredAttr.getValue(tuple);</span>
<span class="source-line-no">093</span><span id="line-93">                </span>
<span class="source-line-no">094</span><span id="line-94">                //if we are looking for max value and the newValue is greater than the one stored</span>
<span class="source-line-no">095</span><span id="line-95">                //then the newValue is the new max value and we submit a tuple to indicate that.</span>
<span class="source-line-no">096</span><span id="line-96">                //and similarly for min.</span>
<span class="source-line-no">097</span><span id="line-97">                if(monitorType == Type.Max &amp;&amp; newValue &gt; value) {</span>
<span class="source-line-no">098</span><span id="line-98">                        value = newValue;</span>
<span class="source-line-no">099</span><span id="line-99">                        getOutput(0).submitAsTuple(value);</span>
<span class="source-line-no">100</span><span id="line-100">                }</span>
<span class="source-line-no">101</span><span id="line-101">                else if(monitorType == Type.Min &amp;&amp; newValue &lt; value) {</span>
<span class="source-line-no">102</span><span id="line-102">                        value = newValue;</span>
<span class="source-line-no">103</span><span id="line-103">                        getOutput(0).submitAsTuple(value);</span>
<span class="source-line-no">104</span><span id="line-104">                }</span>
<span class="source-line-no">105</span><span id="line-105">                getOutput(1).submit(tuple);</span>
<span class="source-line-no">106</span><span id="line-106">        }</span>
<span class="source-line-no">107</span><span id="line-107">}</span>




























































</pre>
</div>
</main>
</body>
</html>
