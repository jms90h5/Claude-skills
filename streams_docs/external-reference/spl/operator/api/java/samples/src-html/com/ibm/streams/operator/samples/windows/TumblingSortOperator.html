<!DOCTYPE HTML>
<!-- begin_generated_IBM_Teracloud_ApS_copyright_prolog               -->
<!--                                                                  -->
<!-- This is an automatically generated copyright prolog.             -->
<!-- After initializing,  DO NOT MODIFY OR MOVE                       -->
<!-- **************************************************************** -->
<!-- Licensed Materials - Property of IBM                             -->
<!-- (C) Copyright Teracloud ApS 2025, 2025, IBM Corp. 2025, 2025     -->
<!-- All Rights Reserved.                                             -->
<!-- US Government Users Restricted Rights - Use, duplication or      -->
<!-- disclosure restricted by GSA ADP Schedule Contract with          -->
<!-- IBM Corp.                                                        -->
<!--                                                                  -->
<!-- end_generated_IBM_Teracloud_ApS_copyright_prolog                 -->
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: com.ibm.streams.operator.samples.windows, class: TumblingSortOperator">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/* begin_generated_IBM_Teracloud_ApS_copyright_prolog               */</span>
<span class="source-line-no">002</span><span id="line-2">/*                                                                  */</span>
<span class="source-line-no">003</span><span id="line-3">/* This is an automatically generated copyright prolog.             */</span>
<span class="source-line-no">004</span><span id="line-4">/* After initializing,  DO NOT MODIFY OR MOVE                       */</span>
<span class="source-line-no">005</span><span id="line-5">/* **************************************************************** */</span>
<span class="source-line-no">006</span><span id="line-6">/* THIS SAMPLE CODE IS PROVIDED ON AN "AS IS" BASIS.                */</span>
<span class="source-line-no">007</span><span id="line-7">/* TERACLOUD APS AND IBM MAKES NO REPRESENTATIONS OR WARRANTIES,    */</span>
<span class="source-line-no">008</span><span id="line-8">/* EXPRESS OR IMPLIED, CONCERNING  USE OF THE SAMPLE CODE, OR THE   */</span>
<span class="source-line-no">009</span><span id="line-9">/* COMPLETENESS OR ACCURACY OF THE SAMPLE CODE. TERACLOUD APS       */</span>
<span class="source-line-no">010</span><span id="line-10">/* AND IBM DOES NOT WARRANT UNINTERRUPTED OR ERROR-FREE OPERATION   */</span>
<span class="source-line-no">011</span><span id="line-11">/* OF THIS SAMPLE CODE. TERACLOUD APS AND IBM IS NOT RESPONSIBLE FOR THE */</span>
<span class="source-line-no">012</span><span id="line-12">/* RESULTS OBTAINED FROM THE USE OF THE SAMPLE CODE OR ANY PORTION  */</span>
<span class="source-line-no">013</span><span id="line-13">/* OF THIS SAMPLE CODE.                                             */</span>
<span class="source-line-no">014</span><span id="line-14">/*                                                                  */</span>
<span class="source-line-no">015</span><span id="line-15">/* LIMITATION OF LIABILITY. IN NO EVENT WILL IBM BE LIABLE TO ANY   */</span>
<span class="source-line-no">016</span><span id="line-16">/* PARTY FOR ANY DIRECT, INDIRECT, SPECIAL OR OTHER CONSEQUENTIAL   */</span>
<span class="source-line-no">017</span><span id="line-17">/* DAMAGES FOR ANY USE OF THIS SAMPLE CODE, THE USE OF CODE FROM    */</span>
<span class="source-line-no">018</span><span id="line-18">/* THIS [ SAMPLE PACKAGE,] INCLUDING, WITHOUT LIMITATION, ANY LOST  */</span>
<span class="source-line-no">019</span><span id="line-19">/* PROFITS, BUSINESS INTERRUPTION, LOSS OF PROGRAMS OR OTHER DATA   */</span>
<span class="source-line-no">020</span><span id="line-20">/* ON YOUR INFORMATION HANDLING SYSTEM OR OTHERWISE.                */</span>
<span class="source-line-no">021</span><span id="line-21">/*                                                                  */</span>
<span class="source-line-no">022</span><span id="line-22">/* (C) Copyright Teracloud ApS 2024, 2025, IBM Corp. 2010, 2013     */</span>
<span class="source-line-no">023</span><span id="line-23">/* All Rights reserved.                                             */</span>
<span class="source-line-no">024</span><span id="line-24">/*                                                                  */</span>
<span class="source-line-no">025</span><span id="line-25">/* end_generated_IBM_Teracloud_ApS_copyright_prolog                 */</span>
<span class="source-line-no">026</span><span id="line-26">package com.ibm.streams.operator.samples.windows;</span>
<span class="source-line-no">027</span><span id="line-27"></span>
<span class="source-line-no">028</span><span id="line-28">import java.util.Collections;</span>
<span class="source-line-no">029</span><span id="line-29">import java.util.List;</span>
<span class="source-line-no">030</span><span id="line-30"></span>
<span class="source-line-no">031</span><span id="line-31">import com.ibm.streams.operator.OperatorContext;</span>
<span class="source-line-no">032</span><span id="line-32">import com.ibm.streams.operator.OperatorContext.ContextCheck;</span>
<span class="source-line-no">033</span><span id="line-33">import com.ibm.streams.operator.StreamingInput;</span>
<span class="source-line-no">034</span><span id="line-34">import com.ibm.streams.operator.Tuple;</span>
<span class="source-line-no">035</span><span id="line-35">import com.ibm.streams.operator.compile.OperatorContextChecker;</span>
<span class="source-line-no">036</span><span id="line-36">import com.ibm.streams.operator.model.InputPortSet;</span>
<span class="source-line-no">037</span><span id="line-37">import com.ibm.streams.operator.model.InputPortSet.WindowPunctuationInputMode;</span>
<span class="source-line-no">038</span><span id="line-38">import com.ibm.streams.operator.model.OutputPortSet;</span>
<span class="source-line-no">039</span><span id="line-39">import com.ibm.streams.operator.model.OutputPortSet.WindowPunctuationOutputMode;</span>
<span class="source-line-no">040</span><span id="line-40">import com.ibm.streams.operator.model.Parameter;</span>
<span class="source-line-no">041</span><span id="line-41">import com.ibm.streams.operator.model.PrimitiveOperator;</span>
<span class="source-line-no">042</span><span id="line-42">import com.ibm.streams.operator.model.InputPortSet.WindowMode;</span>
<span class="source-line-no">043</span><span id="line-43">import com.ibm.streams.operator.window.AbstractWindowOperator;</span>
<span class="source-line-no">044</span><span id="line-44">import com.ibm.streams.operator.window.StreamWindow;</span>
<span class="source-line-no">045</span><span id="line-45">import com.ibm.streams.operator.window.sort.TumblingWindowSort;</span>
<span class="source-line-no">046</span><span id="line-46"></span>
<span class="source-line-no">047</span><span id="line-47">/**</span>
<span class="source-line-no">048</span><span id="line-48"> * Sample ascending sort operator for a tumbling window.</span>
<span class="source-line-no">049</span><span id="line-49"> * Extends {@link AbstractWindowOperator} to ensure all tuples</span>
<span class="source-line-no">050</span><span id="line-50"> * and punctuation are handled by the</span>
<span class="source-line-no">051</span><span id="line-51"> * {@link com.ibm.streams.operator.window.StreamWindowListener StreamWindowListener}.</span>
<span class="source-line-no">052</span><span id="line-52"> * &lt;BR&gt;</span>
<span class="source-line-no">053</span><span id="line-53"> * {@link TumblingWindowSort} is used as the StreamWindowListener with</span>
<span class="source-line-no">054</span><span id="line-54"> * the parameter &lt;code&gt;sortAttributes&lt;/code&gt; defining the set of attributes</span>
<span class="source-line-no">055</span><span id="line-55"> * used for ordering. The first attribute in the list is the most significant</span>
<span class="source-line-no">056</span><span id="line-56"> * in the sort order. All the attributes must correspond to a java.lang.Comparable</span>
<span class="source-line-no">057</span><span id="line-57"> * object type.</span>
<span class="source-line-no">058</span><span id="line-58"> * &lt;BR&gt;</span>
<span class="source-line-no">059</span><span id="line-59"> * The optional boolean parameter &lt;code&gt;flushOnFinal&lt;/code&gt; indicates if</span>
<span class="source-line-no">060</span><span id="line-60"> * the remaining tuples in the window should be flushed and submitted to</span>
<span class="source-line-no">061</span><span id="line-61"> * the output port in sorted order when a final punctuation mark is received.</span>
<span class="source-line-no">062</span><span id="line-62"> * The default is false which means tuples remaining in the window</span>
<span class="source-line-no">063</span><span id="line-63"> * are discarded upon a final mark. Set to true to flush remaining tuples.</span>
<span class="source-line-no">064</span><span id="line-64"> * &lt;P&gt;</span>
<span class="source-line-no">065</span><span id="line-65"> * Requires a single tumbling windowed input port and a single output port.</span>
<span class="source-line-no">066</span><span id="line-66"> * &lt;/P&gt;</span>
<span class="source-line-no">067</span><span id="line-67"> * &lt;P&gt;</span>
<span class="source-line-no">068</span><span id="line-68"> * This operator provided as the sample Java primitive operator</span>
<span class="source-line-no">069</span><span id="line-69"> * &lt;BR&gt;</span>
<span class="source-line-no">070</span><span id="line-70"> * {@code com.ibm.streams.javaprimitivesamples.windows.TumblingSort}</span>
<span class="source-line-no">071</span><span id="line-71"> * &lt;BR&gt;</span>
<span class="source-line-no">072</span><span id="line-72"> * in the sample {@code JavaOperators} toolkit located in:</span>
<span class="source-line-no">073</span><span id="line-73"> * &lt;BR&gt;</span>
<span class="source-line-no">074</span><span id="line-74"> * {@code $STREAMS_INSTALL/samples/spl/feature/JavaOperators}</span>
<span class="source-line-no">075</span><span id="line-75"> * &lt;/P&gt;</span>
<span class="source-line-no">076</span><span id="line-76"> */</span>
<span class="source-line-no">077</span><span id="line-77">@PrimitiveOperator(name="TumblingSort",</span>
<span class="source-line-no">078</span><span id="line-78">        description="Sample ascending sort operator for a tumbling window.",</span>
<span class="source-line-no">079</span><span id="line-79">        comment=TumblingSortOperator.IBM_Teracloud_ApS_COPYRIGHT)</span>
<span class="source-line-no">080</span><span id="line-80">@InputPortSet(cardinality=1,windowingMode=WindowMode.Windowed,windowPunctuationInputMode=WindowPunctuationInputMode.WindowBound)</span>
<span class="source-line-no">081</span><span id="line-81">@OutputPortSet(cardinality=1,windowPunctuationOutputMode=WindowPunctuationOutputMode.Generating)</span>
<span class="source-line-no">082</span><span id="line-82">public class TumblingSortOperator extends AbstractWindowOperator {</span>
<span class="source-line-no">083</span><span id="line-83">    </span>
<span class="source-line-no">084</span><span id="line-84">    private boolean flushOnFinal = false;</span>
<span class="source-line-no">085</span><span id="line-85">    private List&lt;String&gt; sortAttributes = Collections.emptyList();</span>
<span class="source-line-no">086</span><span id="line-86">    </span>
<span class="source-line-no">087</span><span id="line-87">    /**</span>
<span class="source-line-no">088</span><span id="line-88">     * Perform a tumbling sort using the attributes</span>
<span class="source-line-no">089</span><span id="line-89">     * defined by the SPL parameter sortAttributes.</span>
<span class="source-line-no">090</span><span id="line-90">     * Assumes the operator has a single</span>
<span class="source-line-no">091</span><span id="line-91">     * input port and a single output port.</span>
<span class="source-line-no">092</span><span id="line-92">     * </span>
<span class="source-line-no">093</span><span id="line-93">     */</span>
<span class="source-line-no">094</span><span id="line-94">    @Override</span>
<span class="source-line-no">095</span><span id="line-95">    public void initialize(OperatorContext context) throws Exception {</span>
<span class="source-line-no">096</span><span id="line-96">        super.initialize(context);</span>
<span class="source-line-no">097</span><span id="line-97">        </span>
<span class="source-line-no">098</span><span id="line-98">        StreamWindow&lt;Tuple&gt; window = getInput(0).getStreamWindow();</span>
<span class="source-line-no">099</span><span id="line-99">        </span>
<span class="source-line-no">100</span><span id="line-100">        new TumblingWindowSort(window, true,</span>
<span class="source-line-no">101</span><span id="line-101">                getSortAttributes(),</span>
<span class="source-line-no">102</span><span id="line-102">                getOutput(0),</span>
<span class="source-line-no">103</span><span id="line-103">                isFlushOnFinal());</span>
<span class="source-line-no">104</span><span id="line-104">    }</span>
<span class="source-line-no">105</span><span id="line-105">    </span>
<span class="source-line-no">106</span><span id="line-106">    /**</span>
<span class="source-line-no">107</span><span id="line-107">     * Check the input port is tumbling.</span>
<span class="source-line-no">108</span><span id="line-108">     */</span>
<span class="source-line-no">109</span><span id="line-109">    @ContextCheck</span>
<span class="source-line-no">110</span><span id="line-110">    public static void requireTumblingWindow(final OperatorContextChecker checker) {</span>
<span class="source-line-no">111</span><span id="line-111">        final StreamingInput&lt;Tuple&gt; inputPort =</span>
<span class="source-line-no">112</span><span id="line-112">            checker.getOperatorContext().getStreamingInputs().get(0);</span>
<span class="source-line-no">113</span><span id="line-113">        checker.checkTumblingWindow(inputPort);</span>
<span class="source-line-no">114</span><span id="line-114">    }</span>
<span class="source-line-no">115</span><span id="line-115"></span>
<span class="source-line-no">116</span><span id="line-116">    /**</span>
<span class="source-line-no">117</span><span id="line-117">     * Flush sort buffer when final punctuation mark is processed.</span>
<span class="source-line-no">118</span><span id="line-118">     * @param flushOnFinal True to submit outstanding tuples, false to discard them.</span>
<span class="source-line-no">119</span><span id="line-119">     */</span>
<span class="source-line-no">120</span><span id="line-120">    @Parameter(optional=true,</span>
<span class="source-line-no">121</span><span id="line-121">            description="Flush sort buffer when final punctuation mark is processed."</span>
<span class="source-line-no">122</span><span id="line-122">            )</span>
<span class="source-line-no">123</span><span id="line-123">    public void setFlushOnFinal(boolean flushOnFinal) {</span>
<span class="source-line-no">124</span><span id="line-124">        this.flushOnFinal = flushOnFinal;</span>
<span class="source-line-no">125</span><span id="line-125">    }</span>
<span class="source-line-no">126</span><span id="line-126"></span>
<span class="source-line-no">127</span><span id="line-127">    /**</span>
<span class="source-line-no">128</span><span id="line-128">     * True if outstanding tuples are submitted when final markers are processed, false</span>
<span class="source-line-no">129</span><span id="line-129">     * if they are discarded.</span>
<span class="source-line-no">130</span><span id="line-130">     */</span>
<span class="source-line-no">131</span><span id="line-131">    public boolean isFlushOnFinal() {</span>
<span class="source-line-no">132</span><span id="line-132">        return flushOnFinal;</span>
<span class="source-line-no">133</span><span id="line-133">    }</span>
<span class="source-line-no">134</span><span id="line-134"></span>
<span class="source-line-no">135</span><span id="line-135">    /**</span>
<span class="source-line-no">136</span><span id="line-136">     * Names of the attributes to perform the sort on.</span>
<span class="source-line-no">137</span><span id="line-137">     * If not supplied then all comparable attributes</span>
<span class="source-line-no">138</span><span id="line-138">     * will be used as the sort key, with priority</span>
<span class="source-line-no">139</span><span id="line-139">     * given to attributes with the lower index.</span>
<span class="source-line-no">140</span><span id="line-140">     */</span>
<span class="source-line-no">141</span><span id="line-141">    @Parameter(optional=true, description="Names of the attributes to perform the sort on. If not supplied then all comparable attributes will be used as the sort key, with priority given to attributes with the lower index.")</span>
<span class="source-line-no">142</span><span id="line-142">    public void setSortAttributes(List&lt;String&gt; sortAttributes) {</span>
<span class="source-line-no">143</span><span id="line-143">        this.sortAttributes = sortAttributes;</span>
<span class="source-line-no">144</span><span id="line-144">    }</span>
<span class="source-line-no">145</span><span id="line-145"></span>
<span class="source-line-no">146</span><span id="line-146">    public List&lt;String&gt; getSortAttributes() {</span>
<span class="source-line-no">147</span><span id="line-147">        return sortAttributes;</span>
<span class="source-line-no">148</span><span id="line-148">    }</span>
<span class="source-line-no">149</span><span id="line-149">}</span>




























































</pre>
</div>
</main>
</body>
</html>
