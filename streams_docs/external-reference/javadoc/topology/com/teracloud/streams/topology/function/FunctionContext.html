<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>FunctionContext (Java Application API for Streams)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.teracloud.streams.topology.function, interface: FunctionContext">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.teracloud.streams.topology.function</a></div>
<h1 title="Interface FunctionContext" class="title">Interface FunctionContext</h1>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">FunctionContext</span></div>
<div class="block">Context for a function executing in a Streams application.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#addClassLibraries(java.lang.String%5B%5D)" class="member-name-link">addClassLibraries</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;libraries)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Add class libraries to the functional class loader.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#createCustomMetric(java.lang.String,java.lang.String,java.lang.String,java.util.function.LongSupplier)" class="member-name-link">createCustomMetric</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;description,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;kind,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/LongSupplier.html" title="class or interface in java.util.function" class="external-link">LongSupplier</a>&nbsp;value)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Create a custom metric.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getChannel()" class="member-name-link">getChannel</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the index of the parallel channel the function is on.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="FunctionContainer.html" title="interface in com.teracloud.streams.topology.function">FunctionContainer</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getContainer()" class="member-name-link">getContainer</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the container hosting a function</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getCustomMetricNames()" class="member-name-link">getCustomMetricNames</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the set of custom metric names created in this context.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getMaxChannels()" class="member-name-link">getMaxChannels</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the total number of parallel channels for the parallel region that
 the function is in.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledExecutorService</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getScheduledExecutorService()" class="member-name-link">getScheduledExecutorService</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Return a scheduler to execute background tasks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ThreadFactory.html" title="class or interface in java.util.concurrent" class="external-link">ThreadFactory</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getThreadFactory()" class="member-name-link">getThreadFactory</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Return a ThreadFactory that can be used by the function with the thread context
 class loader set correctly.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getContainer()">
<h3>getContainer</h3>
<div class="member-signature"><span class="return-type"><a href="FunctionContainer.html" title="interface in com.teracloud.streams.topology.function">FunctionContainer</a></span>&nbsp;<span class="element-name">getContainer</span>()</div>
<div class="block">Get the container hosting a function</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Container hosting a function.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getScheduledExecutorService()">
<h3>getScheduledExecutorService</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ScheduledExecutorService.html" title="class or interface in java.util.concurrent" class="external-link">ScheduledExecutorService</a></span>&nbsp;<span class="element-name">getScheduledExecutorService</span>()</div>
<div class="block">Return a scheduler to execute background tasks. Functions should utilize
 this service or <a href="#getThreadFactory()"><code>getThreadFactory()</code></a> rather than creating their own threads
 to ensure that the SPL runtime will wait for any background work
 before completing an application.
 <P>
 The scheduler will be shutdown when the processing element is to be shutdown.
 Once the scheduler is shutdown no new tasks will be accepted. Existing
 scheduled tasks will remain in the scheduler's queue but periodic tasks
 will canceled.
 <BR>
 Functions that implement <code>AutoCloseable</code> that wish to complete any outstanding tasks
 at close time can call <code>ExecutorService.awaitTermination()</code>
 to wait for outstanding tasks to complete or wait on the specific
 <code>Future</code> reference for a task.
 </P>
 
 <P>
 The returned scheduler service is guaranteed to be an instance
 of <code>java.util.concurrent.ScheduledThreadPoolExecutor</code>
 and initially has this configuration:
 <UL>
 <LI> <code>corePoolSize</code> Set to <code>Runtime.availableProcessors()</code> with
 a minimum of 2 and maximum of 8. </LI>
 <LI> <code>allowsCoreThreadTimeOut()</code> set to <code>true</code></LI>
 <LI> <code>keepAliveTime</code> set to 5 seconds</LI>
 </UL>
 Threads are created on demand to execute tasks, so that even if the
 <code>corePoolSize</code> is eight, eight threads will only be created if
 there are eight concurrent tasks scheduled. Threads will be removed
 if they are not needed for the <code>keepAliveTime</code> value and
 <code>allowsCoreThreadTimeOut()</code> returns <code>true</code>.
 </P></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Scheduler service that can be used by the function.</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li>"java.util.concurrent.ExecutorService"</li>
<li>"java.util.concurrent.Future"</li>
<li>"java.util.concurrent.ScheduledThreadPoolExecutor"</li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getThreadFactory()">
<h3>getThreadFactory</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ThreadFactory.html" title="class or interface in java.util.concurrent" class="external-link">ThreadFactory</a></span>&nbsp;<span class="element-name">getThreadFactory</span>()</div>
<div class="block">Return a ThreadFactory that can be used by the function with the thread context
 class loader set correctly. Functions should utilize
 the returned factory to create Threads.
 <P>
 Threads returned by the ThreadFactory have not been started
 and are set as daemon threads. Functions may set the threads
 as non-daemon before starting them. The SPL runtime will wait
 for non-daemon threads before terminating a processing
 element in standalone mode.
 </P>
 <P>
 Any uncaught exception thrown by the <code>Runnable</code> passed
 to the <code>ThreadFactory.newThread(Runnable)</code> will cause
 the processing element containing the function to terminate.
 </P>
 <P>
 The ThreadFactory will be shutdown when the processing element is to be shutdown.
 Once the ThreadFactory
 is shutdown a call to <code>newThread()</code> will return null.
 </P></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A ThreadFactory that can be used by the function.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getChannel()">
<h3>getChannel</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">getChannel</span>()</div>
<div class="block">Get the index of the parallel channel the function is on.
 <P>
 If the function is in a parallel region, this method returns a value from
 0 to N-1, where N is the <a href="#getMaxChannels()"><code>number of channels in the parallel region</code></a>;
 otherwise it returns -1.
 </P></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the index of the parallel channel if the
         function is executing in a parallel region, or -1 if the function
         is not executing in a parallel region.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMaxChannels()">
<h3>getMaxChannels</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">getMaxChannels</span>()</div>
<div class="block">Get the total number of parallel channels for the parallel region that
 the function is in. If the function is not in a parallel region, this
 method returns 0.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the number of parallel channels for the parallel region that this
         function is in, or 0 if the function is not in a parallel region.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addClassLibraries(java.lang.String[])">
<h3>addClassLibraries</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">addClassLibraries</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;libraries)</span>
                throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/net/MalformedURLException.html" title="class or interface in java.net" class="external-link">MalformedURLException</a></span></div>
<div class="block">Add class libraries to the functional class loader. The functional
 class loader is set as the thread context class loader for
 <a href="#getThreadFactory()"><code>thread factory</code></a>,
 <a href="#getScheduledExecutorService()"><code>executor</code></a> and any method
 invocation on the function instance.
 <P>
 Functions use this method to add class libraries specific
 to the invocation in
 a consistent manner. An example is defining the jar files that
 contain the JDBC driver to be used by the application.
 <P>
 Each element of <code>libraries</code> is trimmed and then converted 
 into a <code>java.net.URL</code>. If the element cannot be converted
 to a <code>URL</code> then it is assumed to represent a file system
 path and is converted into an <code>URL</code> representing that path.
 If the file path is relative the used location is currently
 undefined, thus use of relative paths are not recommended.
 <BR>
 If a file path ends with <code>/* </code> then it is assumed to
 be a directory and all jar files in the directory
 with the extension <code>.jar</code> or <code>.JAR</code> are
 added to the function class loader.
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>libraries</code> - String representations of URLs and file paths to be
 added into the functional class loader. If <code>null</code> then no libraries
 are added to the class loader.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/net/MalformedURLException.html" title="class or interface in java.net" class="external-link">MalformedURLException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createCustomMetric(java.lang.String,java.lang.String,java.lang.String,java.util.function.LongSupplier)">
<h3>createCustomMetric</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">createCustomMetric</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;description,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;kind,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/LongSupplier.html" title="class or interface in java.util.function" class="external-link">LongSupplier</a>&nbsp;value)</span></div>
<div class="block">Create a custom metric.
 <BR>
 A custom metric allows monitoring of an application through
 Streams monitoring APIs including Streams console and the REST apis.
 
 A metric has a single <code>long</code> value and has a kind of:
 <UL>
 <LI><code>counter</code> - A counter metric observes a value that
 represents a count of an occurrence.</LI>
 <LI><code>gauge</code> - A gauge metric observes a value that is continuously variable with time.
 <LI><code>time</code> - A time metric represents a point in time. It is recommended that the
 value represents the number of milliseconds since the 1970/01/01 epoch, i.e. a
 value consistent with <code>System.currentTimeMillis()</code>.
 </UL>
 <BR>
 The initial value of the metric is set from <code>value.getAsLong()</code> during this
 method call. Subsequently, periodically <code>value.getAsLong()</code> will be called
 to get the current value of the metric so that it can be reported through the monitoring APIs.
 <P>
 A lambda expression can be used as the supplier, for example to monitor the length
 of a queue (or any collection) <code>items</code> a metric can be created from
 <a href="Initializable.html#initialize(com.teracloud.streams.topology.function.FunctionContext)"><code>Initializable.initialize(FunctionContext)</code></a> as:
 <pre>
 <code>
     this.items = new PriorityQueue();
     functionContext.createCustomMetric("queuedItems", "Number of queued items.",
               "gauge", () -> this.items.size());
 </code>
 </pre>
 The metric will now automatically track the length of the queue (subject to the
 periodic collection cycle).
 </P>
 <P>
 A <code>java.util.concurrent.atomic.AtomicLong</code> can be used as a metric's value,
 for example a counter where no other natural value exists, e.g.:
 <pre>
 <code>
     this.nFailedRequests = new AtomicLong();
     functionContext.createCustomMetric("nFailedRequests", "Number of failed requests.",
               "counter", this.nFailedRequests::get);
 </code>
 </pre>
 Subsequently the counter is incremented using:
 <pre>
 <code>
     this.nFailedRequests.incrementAndGet();
 </code>
 </pre>
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>name</code> - Name of the metric.</dd>
<dd><code>description</code> - Description of the metric.</dd>
<dd><code>kind</code> - Kind of the metric.</dd>
<dd><code>value</code> - function that returns the value of the metric</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - A metric with <code>name</code> already exists or <code>kind</code> is
 not valid.</dd>
<dt>Since:</dt>
<dd>1.7</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCustomMetricNames()">
<h3>getCustomMetricNames</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">getCustomMetricNames</span>()</div>
<div class="block">Get the set of custom metric names created in this context.
 
 The set may include additional metrics not created by this function
 including metric created by the topology framework.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The set of custom metric names created in this context.</dd>
<dt>Since:</dt>
<dd>1.7</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
